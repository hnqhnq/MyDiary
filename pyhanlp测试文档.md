## pyhanlp测试



### 有缓存字典bin文件的情况

> 输出格式：字典，提取人名、地名、机构名、时间。

#### 同时开启人名地名机构名

>  同时开启识别按钮，即遍历这三类字典

##### 只启动一次

> 使用遍历循环测试各数量级数据运行时长：

```bash
2018-11-20 01:25:59,557 - INFO - ----ner_main测试日志----

2018-11-20 01:26:01,135 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：1.2548446655273438s

2018-11-20 01:26:01,321 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.18502020835876465s

2018-11-20 01:26:01,567 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.2441253662109375s

2018-11-20 01:26:02,066 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.49831247329711914s

2018-11-20 01:31:34,415 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：332.2360818386078s(5.53min)

2018-11-20 03:11:51,298 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：6014.469685792923s(1.67h)

```



##### 分开启动运行

> 启动一次，只运行一个数量级数据测试运行时长：

```bash
2018-11-19 23:46:54,525 - INFO - ----ner_single_main测试日志----

2018-11-19 23:46:55,898 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：1.3721637725830078s

2018-11-19 23:50:46,976 - INFO - ----ner_single_main测试日志----

2018-11-19 23:50:47,839 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.8611330986022949s

2018-11-19 23:51:04,205 - INFO - ----ner_single_main测试日志----

2018-11-19 23:51:05,610 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：1.4048404693603516s

2018-11-19 23:51:27,085 - INFO - ----ner_single_main测试日志----

2018-11-19 23:56:33,775 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：306.68928265571594s(5.53min)

2018-11-20 01:29:13,779 - INFO - ----ner_single_main测试日志----

2018-11-20 03:09:46,384 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：6032.603602170944s(1.67h)

```



> 备注：t10代表10条数据量，文件大小在（）里面，时长==耗时 
>
> **小结**：发现分开运行和一次遍历运行时长差距不大，后期测试按启动一次即可。



---

#### stanford与pyhanlp测试对比

测试各数量级的实体抽取耗费时长：

> 提取实体：人名、地名、机构名、时间

| **条数** | **大小** | **stanfordnlp-时间(s)** | **pyhanlp-时间(s)**  |
| -------- | -------- | :---------------------- | -------------------- |
| 2        | 0.41KB   | none                    | 1.254                |
| 10       | 1.72KB   | none                    | 0.185                |
| 33       | 2.61KB   | none                    | 0.244                |
| 36       | 8.83KB   | none                    | 0.498                |
| 11740    | 1.5M     | 293.916（4.89min）      | 85.274（1.42min）    |
| 20000    | 8.24M    | none                    | 306.689（5.53min）   |
| 61140    | 3.1M     | 767.025（12.78min）     | 236.192（3.936min）  |
| 215032   | 17M      | 3341.131（55.68min）    | 1053.440（17.55min） |
| 1009437  | 90M      | 16996.652（4.72h）      | 6032.603（1.67h）    |

---

#### 开启人名name

> 只开启识别人名

```bash
2018-11-20 17:35:30,880 - INFO - ----ner_main测试日志----
2018-11-20 17:35:31,460 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：0.5792837142944336s
2018-11-20 17:35:31,589 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.12839198112487793s
2018-11-20 17:35:31,770 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.1796426773071289s
2018-11-20 17:35:32,177 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.40581274032592773s
2018-11-20 17:40:32,171 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：299.85798621177673s
2018-11-20 18:58:04,536 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：4650.457965373993s

2018-11-20 22:34:14,415 - INFO - ----ner_single_main测试日志----
2018-11-20 22:35:28,081 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：73.66488528251648s
2018-11-20 22:57:21,709 - INFO - ----ner_single_main测试日志----
2018-11-20 23:01:29,425 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：247.715505361557s
2018-11-20 23:13:11,683 - INFO - ----ner_single_main测试日志----
2018-11-20 23:30:17,724 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：1026.03963804245s
```



| **条数** | **大小** | **name-时间(s)**     |
| -------- | -------- | -------------------- |
| 2        | 0.41KB   | 0.579                |
| 10       | 1.72KB   | 0.128                |
| 33       | 2.61KB   | 0.179                |
| 36       | 8.83KB   | 0.405                |
| 11740    | 1.5M     | 73.664（1.22min）    |
| 20000    | 8.24M    | 299.857（4.99min）   |
| 61140    | 3.1M     | 247.715（4.12min）   |
| 215032   | 17M      | 1026.039（17.10min） |
| 1009437  | 90M      | 4650.457（1.29h）    |



#### 开启地名loc

> 只开启识别地名

已经测试完了，明天记得看*_name.log

```bash
2018-11-20 23:58:20,856 - INFO - -----ner_main.py测试日志[开启识别：loc]-------
2018-11-20 23:58:21,474 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：0.616736650466919s
2018-11-20 23:58:21,596 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.12097477912902832s
2018-11-20 23:58:21,747 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.14965415000915527s
2018-11-20 23:58:22,145 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.39731764793395996s
2018-11-20 23:59:35,078 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：1.2148367802302042min
2018-11-21 00:05:06,476 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：5.520321599642435min
2018-11-21 00:08:44,191 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：3.6263460079828898min
2018-11-21 00:25:38,923 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：16.90371980667114min
2018-11-21 01:52:35,247 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：86.89544155995051min
```

| **条数** | **大小** | **loc-时间(s)**    |
| -------- | -------- | ------------------ |
| 2        | 0.41KB   | 0.616              |
| 10       | 1.72KB   | 0.120              |
| 33       | 2.61KB   | 0.149              |
| 36       | 8.83KB   | 0.397              |
| 11740    | 1.5M     | 1.214min           |
| 20000    | 8.24M    | 5.520min           |
| 61140    | 3.1M     | 3.626min           |
| 215032   | 17M      | 16.903min          |
| 1009437  | 90M      | 86.895min（1.44h） |



#### 开启机构名org

> 只开启识别机构名

```bash
2018-11-21 17:47:09,652 - INFO - -----ner_main.py测试日志[开启识别：org]-------
2018-11-21 17:47:10,977 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：1.3238062858581543s
2018-11-21 17:47:11,264 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.2856709957122803s
2018-11-21 17:47:11,554 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.28873467445373535s
2018-11-21 17:47:12,403 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.8476555347442627s
2018-11-21 17:48:28,702 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：1.2709664543469747min
2018-11-21 17:54:23,396 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：5.90898159344991min
2018-11-21 17:58:06,096 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：3.7100262085596722min
2018-11-21 18:15:06,997 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：17.0065434495608min
2018-11-21 19:44:41,449 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：89.53625834385554min
```

| **条数** | **大小** | **org-时间(s)**    |
| -------- | -------- | ------------------ |
| 2        | 0.41KB   | 1.323              |
| 10       | 1.72KB   | 0.285              |
| 33       | 2.61KB   | 0.288              |
| 36       | 8.83KB   | 0.847              |
| 11740    | 1.5M     | 1.270min           |
| 20000    | 8.24M    | 5.908min           |
| 61140    | 3.1M     | 3.710min           |
| 215032   | 17M      | 17.006min          |
| 1009437  | 90M      | 89.536min（1.49h） |

#### 开启地名+机构名loc_org

```bash
2018-11-22 00:01:51,614 - INFO - -----ner_main.py测试日志[开启识别：loc_org]-------
2018-11-22 00:01:53,031 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：1.416137933731079s
2018-11-22 00:01:54,656 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.09184861183166504s
2018-11-22 00:01:54,814 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.15749454498291016s
2018-11-22 00:01:55,380 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.5648727416992188s
2018-11-22 00:03:16,998 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：1.3596859931945802min
2018-11-22 00:09:04,454 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：5.788169340292613min
2018-11-22 00:12:45,429 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：3.6813114245732623min
2018-11-22 00:29:18,713 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：16.545295977592467min
2018-11-22 01:54:11,329 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：84.83916711012522min
```

| 条数    | 大小   | loc_org-时间(s)  |
| ------- | ------ | ---------------- |
| 2       | 0.41KB | 1.416            |
| 10      | 1.72KB | 0.091            |
| 33      | 2.61KB | 0.157            |
| 36      | 8.83KB | 0.564            |
| 11740   | 1.5M   | 1.359min         |
| 20000   | 8.24M  | 5.788min         |
| 61140   | 3.1M   | 3.681min         |
| 215032  | 17M    | 16.545min        |
| 1009437 | 90M    | 84.839min(1.41h) |



#### 不开启实体字典none

```python
2018-11-22 17:04:56,128 - INFO - -----ner_main.py测试日志[开启识别：none]-------
2018-11-22 17:04:56,769 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：0.6407444477081299s
2018-11-22 17:04:56,919 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.14868831634521484s
2018-11-22 17:04:57,140 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.21921992301940918s
2018-11-22 17:04:57,702 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.5584444999694824s
2018-11-22 17:06:07,693 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：1.1658056060473123min
2018-11-22 17:11:55,856 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：5.800731205940247min
2018-11-22 17:15:29,610 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：3.560196101665497min
2018-11-22 17:31:49,216 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：16.319225629170734min
2018-11-22 18:56:26,243 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：84.57612394491831min
```



| 条数    | 大小   | none-时间(s)     |
| ------- | ------ | ---------------- |
| 2       | 0.41KB | 0.64             |
| 10      | 1.72KB | 0.148            |
| 33      | 2.61KB | 0.219            |
| 36      | 8.83KB | 0.558            |
| 11740   | 1.5M   | 1.165min         |
| 20000   | 8.24M  | 5.800min         |
| 61140   | 3.1M   | 3.560min         |
| 215032  | 17M    | 16.319min        |
| 1009437 | 90M    | 84.576min(1.40h) |



---

#### pyhanlp实体识别测试对比

- 开启选项：all/name/loc/org/loc_org(同开loc,org)
- 默认：时间（s）

|  条数   |  大小  |   all    |   name   |    loc    |    org    |  loc_org  |   none    |
| :-----: | :----: | :------: | :------: | :-------: | :-------: | :-------: | :-------: |
|    2    | 0.41KB |  1.254   |  0.579   |   0.616   |   1.323   |   1.416   |   0.64    |
|   10    | 1.72KB |  0.185   |  0.128   |   0.12    |   0.285   |   0.091   |   0.148   |
|   33    | 2.61KB |  0.244   |  0.179   |   0.149   |   0.288   |   0.157   |   0.219   |
|   36    | 8.83KB |  0.498   |  0.405   |   0.397   |   0.847   |   0.564   |   0.558   |
|  11740  |  1.5M  | 1.42min  | 1.22min  | 1.214min  | 1.270min  | 1.359min  | 1.165min  |
|  20000  | 8.24M  | 5.53min  | 4.99min  | 5.520min  | 5.908min  | 5.788min  | 5.800min  |
|  61140  |  3.1M  | 3.936min | 4.12min  | 3.626min  | 3.710min  | 3.681min  | 3.560min  |
| 215032  |  17M   | 17.55min | 17.10min | 16.903min | 17.006min | 16.545min | 16.319min |
| 1009437 |  90M   |  1.67h   |  1.29h   |   1.44h   |   1.49h   |   1.41h   |   1.40h   |



### 无缓存字典bin文件的情况

#### 同时开启人名地名机构名



##### 新增字典数量级1M

> 新增20w行1.6MB数量级字典测试没有缓存字典情况的运行速度

```bash
2018-11-23 00:22:11,853 - INFO - -----ner_main.py测试日志[开启识别：all]-------
2018-11-23 00:23:55,111 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：1.720858168601989
2018-11-23 00:23:55,246 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.13353276252746
2018-11-23 00:23:55,487 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.23958230018615
2018-11-23 00:23:56,010 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.52170467376708
2018-11-23 00:25:10,913 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：1.24775852759
2018-11-23 00:30:56,962 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：5.76459317604
2018-11-23 00:34:55,706 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：3.97703519264
2018-11-23 00:52:04,629 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：17.14027774
2018-11-23 02:20:23,721 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：88.28027648
```



##### 新增字典数量级10M

> 新增 20w+11w+30w+35w=96w行10MB数量级字典测试没有缓存字典情况的运行速度

```bash
2018-11-23 16:56:43,810 - INFO - -----ner_main.py测试日志[开启识别：all]-------
2018-11-23 16:59:11,716 - INFO - 文件t2_test.txt--大小(0.41KB)--耗时：2.46505827109019min
2018-11-23 16:59:11,925 - INFO - 文件t10_test.txt--大小(1.72KB)--耗时：0.2075183391571045s
2018-11-23 16:59:12,135 - INFO - 文件t33_test.txt--大小(2.61KB)--耗时：0.207993745803833s
2018-11-23 16:59:12,731 - INFO - 文件t36_test.txt--大小(8.83KB)--耗时：0.593977689743042s
2018-11-23 17:00:23,606 - INFO - 文件t11740_test.txt--大小(1.48MB)--耗时：1.1805489818255106min
2018-11-23 17:05:10,937 - INFO - 文件t20000_test.txt--大小(8.24MB)--耗时：4.786617334683736min
2018-11-23 17:08:39,285 - INFO - 文件t61140_test.txt--大小(3.05MB)--耗时：3.4708261926968893min
2018-11-23 17:24:19,517 - INFO - 文件t215032_test.txt--大小(16.49MB)--耗时：15.661593214670818min
2018-11-23 18:48:55,552 - INFO - 文件million_test.txt--大小(89.61MB)--耗时：84.56404485702515min
```



##### 新增字典数量级100M

> 
>
> 新增 250w行104MB数量级字典测试没有缓存字典情况的运行速度——>
>
> 
>
> 新增 480w行168MB数量级字典测试没有缓存字典情况的运行速度——>根本跑不起来了。





